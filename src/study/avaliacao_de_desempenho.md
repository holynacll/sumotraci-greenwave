# Processo Experimental Sistemático
  - ## Problema:
    - É preciso que os veículos de emergência tenham um caminho mais livre possível. Veículos de Emergência tem passe livre para passar de sinais vermelhos, porém com o alto volume veículos no trânsito, aliado ao controle dos semáforos padrão (abre e fecha de forma temporizada), congestionamentos podem ser produzidos no caminho por onde o veículo de emergência irá passar. Nesse momento, os veículos normais se tornam obstáculos que não permitem a passagem do veículo de emergência, prejudicando na duração da viagem. 
  - ## Pergunta:
    - De que forma é possível melhorar o trânsito para que o veículo de emergência tenha um caminho mais livre possível?
    - Modificando o comportamento do controle de sinais de trânsito para que se abram a medida que veículos de emergência se aproximem, fazendo com que o fluxo do caminho que o veículo de emergência percorre melhore, onde os veículos normais vão deixar de ser obstáculos parados em frente ao veículo de emergência, e consequentemente o fluxo do veículo de emergência melhore também. Dessa forma, reduzindo a duração da viagem.
  - ## Métricas selecionadas:
    - Duração da viagem (segundos)
    - Tempo perdido na viagem (somátorio do tempo de paradas, quando velocidade do veículo == 0 por pelo menos > 0.01 segundo, começa a contar o tempo perdido) (segundos)
    - Quantificação das ocorrências de acidentes salvos e não salvos de acordo com deadline (int)

  - ## Parâmetros identificados:
    - Número de veículos: 4800
    - Frequência de acidentes: 1 acidente a cada 50 ou 100 segundos (selecionado)
    - Tempo de atraso no envio de veículo de emergência: 30 ou 120 segundos (selecionado)
    - Modelo de seguimento de carro: Krauss ou EIDM
    - Algoritmo de controle dos semáforos: Padrão Temporizado ou Green Wave
    - Número máximo de vias acidentadas: 4
    - Distância do veículo de emergência ao semáforo para, para acionamento do green wave: 300 métros
    - Tempo de bloqueio para novo acidente em uma via que acabou de resolver um acidente: 300 segundos
    - Quantidade máxima de acidentes numa mesma via: 1
    - Tempo de simulação, onde serão gerados acidentes e disparado veículos de emergência para atender os acidentes (O tempo total da simulação será o tempo até que todos os veículos inseridos na simulação tenham completado suas viagens, ou que todos os acidentes gerados tenham sido resolvidos e os veículos de emergência tenham completado sua viagem (saída do hospital -> local do acidente -> hospital de destino), logo tempo de simulação será diferente do tempo total da simulação): 1200 segundos
    - Comprimento da via: 300 métros
    - Tempo de transição de sinais do green wave: 8.0 segundos
    - Velocidade da via: 13.89 m/s (sumo default)
    - Distância mínima do veículo de emergência ao veículo acidentado para resolver o acidente na via: 15.0 métros
    - Via do Hospital de Dispacho do veículo de emergência: random
    - Via do Hospital de Destino do veículo de emergência: random
    - Vias que podem receber acidentes: random
    - Gravidade do Acidente e Golden Time específico:
      - Crítico: 850
      - Alto: 1000
      - Médio: 1200
      - Baixo: 1500
    - Velocidade da via acidentada: 1.0 m/s
  - ## Parâmetros Selecionados (Fatores):
    - Frequência de acidentes
    - Tempo de atraso no envio de veículo de emergência
    - Modelo de seguimento de carro
    - Algoritmo de controle dos semáforos
  - ## Técnica adotada:
    - Simulação de Trânsito utilizando o SUMO (Simulation of Urban MObility) em conjunto com TraCI API integrado com a linguagem de programação Python.
    - A simulação é reproduzida em um cenario modelo de trânsito de Manhattan, gerado pela ferramenta netgenerate (https://sumo.dlr.de/docs/netgenerate.html), onde um número fixo de veículos trafegam com viagens aleatórias na via, por meio do script randomTrips.py ([https://sumo.dlr.de/docs/Tools/Trip.html](https://sumo.dlr.de/docs/Tools/Trip.html#randomtripspy)), disponibilizado pelo conjunto de ferramentas do SUMO.
    - Na simulação, acidentes são criados de forma artificial, reproduzidos através de um veículo selecionado dinâmicamente de forma pseudo-aleatória, que será parado no meio da viagem e a via onde parou ficará com a velocidade reduzida para simular um acidente. Em seguida, é cadastrado um veículo de emergência para socorrer o veículo acidentado. O veículo de emergência é inserido na simulação após o tempo configurado de despacho (DELAY_DISPATCH), onde inicia a viagem em uma via representada pelo HOSPITAL_POS_START, que segue até o veículo acidentado, e caminha até a via representada pelo HOSPTIAL_POS_END que marca a finalização do atendimento. Quando finalizado uma ocorrência do veículo de emergência, é verificado se o atendimento atendeu ao deadline do acidente incrementando as métricas de SAVEDS (atendeu ao deadline) e UNSAVEDS (não atendeu ao deadline).
    - O Código da solução foi desenvolvido na linguagem de programação Python, que através do TraCI API se integra ao SUMO. Dessa forma, para simular o cenário da solução o código em Python utiliza a API de integração TraCI que envia requisições para o SUMO inserir veículo de emergência, remover veículo acidentado, consultar informações de localização, distância, velocidade, entre outros recursos.
    - Através do uso de seeds pré-determinados em conjunto com devida organização lógica de código  tornamos eventos aleátorios da simulação em determinísticos. Assim, mantemos a reprodutibilidade para avaliar da forma correta a solução proposta.
  - ## Carga de Trabalho
    - A carga de trabalho é dividida entre o código da solução em Python, os scripts das ferramentas do SUMO na criação da rede viária de trânsito (netgenerate) e na criação dos carros e as viagens pseudo-aleatórias com o randomTrips.py, nas chamadas do TraCI API que envia requisições para a simulação adicionando overhead a simulação, e o próprio simulador pelo SUMO.
    - Obtemos os dados das métricas selecionadas para avaliação através do script de geração de relatório *tripinfo-output* disponibilizado pelo SUMO, e as métricas customizadas como os SAVEDS e UNSAVEDS via código da solução em Python.
    - A carga de trabalho é facilmente modificada utilizando a biblioteca argparse da linguagem Python.
  - ## Execução dos Experimentos
    - Planejamento de Projeto Fatorial
    - k = 4 (número de fatores)
    - n = 2^k = 2^4 = 16 combinações
    - Utilização de 10 seeds pré-determinados
    - Total de testes: nº seeds * nº de combinações = 10 * 16 = 160 testes
    os parâmetros foram nívelados da seguinte forma:
      - Frequência de acidentes: 1 acidente a cada 50 ou 100 segundos
      - Tempo de atraso no envio de veículo de emergência: 30 ou 120 segundos após a ocorrência do acidente
      - Modelo de seguimento de carro: Krauss ou EIDM
      - Algoritmo de controle dos semáforos: Padrão Temporizado ou Green Wave
      - Número de veículos: 4800
    - Demais parâmetros estáticos que influênciam a simulação: 
      - Número máximo de vias acidentadas: 4
      - Distância do veículo de emergência ao semáforo para, para acionamento do green wave: 300 métros
      - Tempo de bloqueio para novo acidente em uma via que acabou de resolver um acidente: 300 segundos
      - Quantidade máxima de acidentes numa mesma via: 1
      - Tempo de simulação, onde serão gerados acidentes e disparado veículos de emergência para atender os acidentes (O tempo total da simulação será o tempo até que todos os veículos inseridos na simulação tenham completado suas viagens, ou que todos os acidentes gerados tenham sido resolvidos e os veículos de emergência tenham completado sua viagem (saída do hospital -> local do acidente -> hospital de destino), logo tempo de simulação será diferente do tempo total da simulação): 1200 segundos
      - Comprimento da via: 300 métros
      - Tempo de transição de sinais do green wave: 8.0 segundos
      - Velocidade da via: 13.89 m/s (sumo default)
      - Distância mínima do veículo de emergência ao veículo acidentado para resolver o acidente na via: 15.0 métros
      - Via do Hospital de Dispacho do veículo de emergência: random
      - Via do Hospital de Destino do veículo de emergência: random
      - Vias que podem receber acidentes: random
      - Gravidade do Acidente e Golden Time específico:
        - Crítico: 850
        - Alto: 1000
        - Médio: 1200
        - Baixo: 1500
      - Velocidade da via acidentada: 1.0 m/s
  - ## Analise dos resultados
  - ## Gráficos
  - ## Conclusão
    


